---
- name: Download zip file
  ansible.builtin.get_url:
    url: "{{ app.link }}"
    dest: /opt

- name: Extract HMDM
  unarchive:
    src: /opt/hmdm-server-master.zip
    dest: /opt

- name: Delete HMDM zip file
  file:
    path: /opt/hmdm-server-master.zip
    state: absent

- name: Rename HMDM repo
  shell: mv /opt/hmdm-server-master /opt/hmdm

- name: Recursively change ownership of hmdm directory
  ansible.builtin.file:
    path: /opt/hmdm
    state: directory
    recurse: yes
    owner: "{{ run.user }}"
    group: "{{ run.user }}"



